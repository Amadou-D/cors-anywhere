<!DOCTYPE html>
<html>
<head>
  <title>RSS Feed Reader</title>
</head>
<body>
  <h1>RSS Feed Reader</h1>

  <button id="fetchButton">Fetch Feed</button>

  <p id="results"></p>

  <script>
const feedUrl = "http://localhost:8080/https://www.cbc.ca/webfeed/rss/rss-canada";

  async function getFeedData(feedUrl) {
    try {
      const response = await fetch(feedUrl);
      if (!response.ok) {
        throw new Error(`Failed to fetch feed data: ${response.statusText}`);
      }
      const data = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(data, "text/xml");
      return {
        title: doc.querySelector("title").textContent,
        descriptions: Array.from(doc.querySelectorAll("item description"))
          .map(element => element.textContent)
      };
    } catch (error) {
      console.error("Error fetching feed:", error);
      return Promise.reject(error); // Propagate the error for handling in the click event listener
    }
  }

  const resultsElement = document.getElementById("results");

  const fetchButton = document.getElementById("fetchButton");
  fetchButton.addEventListener("click", async () => {
    try {
      const data = await getFeedData(feedUrl);
      resultsElement.innerHTML = `<h3>Feed Title: ${data.title}</h3>`;
      resultsElement.innerHTML += "<ul>";
      data.descriptions.forEach(description => {
        resultsElement.innerHTML += `<li>${description}</li>`;
      });
      resultsElement.innerHTML += "</ul>";
    } catch (error) {
      // Handle errors (e.g., display an error message to the user)
      resultsElement.textContent = "Error fetching feed data.";
      console.error("Error fetching feed:", error);
    }
  });
  </script>
</body>
</html>
